{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = '54664427-262e44dbf661b4ce462360251';\nconst URL = 'https://pixabay.com/api/';\n\n\nexport async function getImagesByQuery(query, page = 1, per_page = 15) {\n  const response = await axios(URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      page,\n      per_page,\n    }\n  });\n  return response.data;\n}\n","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst list = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadBtn = document.querySelector('.load-more')\n\nconst lightbox = new SimpleLightbox('.gallery-link', {\n    captions: true,\n    captionDelay: 250,\n});\n \nexport function createGallery(images){\n    const markup = images.map(({webformatURL, \n    largeImageURL, \n    tags, \n    likes, \n    views, \n    comments, \n    downloads}) => {\n    return `<li class=\"item-gallery\">\n                <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\">\n                </a>\n                <div class=\"info\">\n                    <div class=\"wrap-info\">\n                        <p class=\"info-text\">Likes</p>\n                        <span class=\"info-number\">${likes}</span>\n                    </div>\n                    <div class=\"wrap-info\">\n                        <p class=\"info-text\">Views</p>\n                        <span class=\"info-number\">${views}</span>\n                    </div>    \n                    <div class=\"wrap-info\">\n                        <p class=\"info-text\">Comments</p>\n                        <span class=\"info-number\">${comments}</span>\n                    </div>    \n                    <div class=\"wrap-info\">\n                        <p class=\"info-text\">Downloads</p>\n                        <span class=\"info-number\">${downloads}</span>\n                    </div> \n                </div>   \n            </li>`\n    }).join(\"\");\n\n    list.insertAdjacentHTML('beforeend', markup);\n    lightbox.refresh();\n}\n\nexport function clearGallery(){\n    list.innerHTML = '';\n}\n\nexport function showLoader(){\n    loader.classList.remove('is-hidden');\n}\n\nexport function hideLoader(){\n    loader.classList.add('is-hidden');\n}\n\n\nexport function showLoadMoreButton() {\n    loadBtn.classList.remove('is-hidden');\n}\n\n\nexport function hideLoadMoreButton() {\n    loadBtn.classList.add('is-hidden');\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByQuery,} from './js/pixabay-api';\nimport { createGallery, clearGallery, showLoader, hideLoader, showLoadMoreButton, hideLoadMoreButton } from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst loadBtn = document.querySelector('.load-more')\n\nlet currentPage = 1;\nconst PER_PAGE = 15;\nlet currentQuery = \"\";\n\nform.addEventListener('submit', handleSubmit);\n\nasync function handleSubmit(e) {\n    e.preventDefault();\n    const input = e.target.elements['search-text'].value.trim();\n\n    if (input.length === 0) {\n        iziToast.error({\n            message: 'Please enter a search query.',\n        });\n        return;\n    }\n\n    clearGallery();\n    hideLoadMoreButton(); \n    showLoader();\n    currentQuery = input;\n    currentPage = 1;\n\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage, PER_PAGE);\n        const images = data.hits || [];\n        const totalPages = Math.ceil(data.totalHits / PER_PAGE);\n\n        if (images.length === 0) {\n            hideLoadMoreButton();\n            iziToast.error({\n                message: \"We're sorry, но you' ve reached the end  of  search results.\"\n            });\n            return\n        } \n            createGallery(images);\n\n            if (totalPages === 1) {\n                hideLoadMoreButton();\n                iziToast.error({\n                    message: \"We're sorry, но you' ve reached the end  of  search results.\"\n                });\n                return\n            } \n                showLoadMoreButton();\n            \n        \n    } catch (error) {\n        iziToast.error({\n            message: 'Something went wrong. Please try again later.',\n        });\n    } finally {\n        hideLoader();\n    }\n\n    e.target.reset();\n}\n\nloadBtn.addEventListener(\"click\", loadSubmit)\n\nasync function loadSubmit(e) {\n    e.preventDefault();\n    currentPage += 1;\n    hideLoadMoreButton(); \n    showLoader();\n\n    try {\n        const data = await getImagesByQuery(currentQuery, currentPage, PER_PAGE);\n        const images = data.hits || [];\n        const totalPages = Math.ceil(data.totalHits / PER_PAGE);\n\n        if (images.length === 0) {\n            hideLoadMoreButton();\n            iziToast.error({\n                message: \"We're sorry, но you' ve reached the end  of  search results.\"\n            });\n            return\n        }  \n            createGallery(images);\n\n            const firstCard = document.querySelector('.item-gallery');\n            if (firstCard) {\n                const { height: cardHeight } = firstCard.getBoundingClientRect();\n                window.scrollBy({\n                    top: cardHeight * 2,\n                    behavior: 'smooth'\n                });\n            }\n            if (currentPage >= totalPages) {\n                hideLoadMoreButton();\n                iziToast.error({\n                    message: \"We're sorry, но you' ve reached the end  of  search results.\"\n                });\n                return\n            }  \n                showLoadMoreButton();\n            \n        \n    } catch (error) {\n        iziToast.error({\n            message: 'Something went wrong. Please try again later.'\n        });\n    } finally {\n        hideLoader();\n    }\n}"],"names":["API_KEY","URL","getImagesByQuery","query","page","per_page","axios","list","loader","loadBtn","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","currentPage","PER_PAGE","currentQuery","handleSubmit","e","input","iziToast","data","totalPages","loadSubmit","firstCard","cardHeight"],"mappings":"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"}